<% if pickup_days.present? %>
  <% pickup_days.each do |day, farm| %>
    <h3><%= format_date(day) %></h3>
    <% farm.each do |farm| %>
      <h4 class="farm-name"><%= farm.first.capitalize %></h4>
      <table class='table table-striped order-table'>
        <tr>
          <th>product</th>
          <th>variety</th>
          <th>quantity</th>
          <th>price</th>
          <th>total price</th>
          <th>ordered on</th>
        </tr>
        <% farm.last.each do |item| %>
          <tr>
            <td><%= item.posting.product.name %></td>
            <td><%= item.posting.product.variety %></td>
            <td><%= quantity_to_s(item) %></td>
            <td><%= quantity_per_unit(item) %></td>
            <td><%= number_to_currency(item.total_cost) %></td>
            <td><%= item.order.created_at.to_date.to_formatted_s %></td>
          </tr>
        <% end %>
      </table>
      <span class="total-text farm-total">FARM TOTAL: </span><span class="total-number farm-total-number"><%= number_to_currency(farm.last.map(&:total_cost).reduce(:+)) %></span>
    <% end %>
    <span class="total-text">DAY TOTAL: </span><span class="total-number day-total-number"><%= number_to_currency(@pickup_days[day].map { |day| day.last }.flatten.map(&:total_cost).reduce(:+)) %></span>
  <% end %>
<% else %>
  <p>You have no active orders</p>
<% end %>
